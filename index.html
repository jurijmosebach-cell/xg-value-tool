<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Football xG Value Analyzer PRO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .match-card {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .match-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        .top-section {
            margin-bottom: 2rem;
        }
        .risk-indicator {
            position: relative;
        }
        .risk-indicator::after {
            content: '';
            position: absolute;
            right: -8px;
            top: 50%;
            transform: translateY(-50%);
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }
        .risk-high::after { background-color: #ef4444; }
        .risk-medium::after { background-color: #f59e0b; }
        .risk-low::after { background-color: #10b981; }
        
        .loading-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .ai-recommendation {
            border-left: 4px solid;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Enhanced Header -->
        <header class="text-center mb-8">
            <div class="flex items-center justify-center space-x-4 mb-4">
                <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-lg">
                    AI
                </div>
                <div>
                    <h1 class="text-4xl font-bold text-gray-800">Football xG Analyzer PRO</h1>
                    <p class="text-gray-600">KI-gest√ºtzte Wettanalyse mit historischen Daten</p>
                </div>
            </div>
            
            <!-- Quick Stats Bar -->
            <div class="grid grid-cols-3 gap-4 max-w-2xl mx-auto mb-6">
                <div class="bg-white rounded-lg p-3 text-center shadow-sm">
                    <div class="text-sm text-gray-600">KI Genauigkeit</div>
                    <div class="text-xl font-bold text-green-600 loading-pulse" id="ai-accuracy">--%</div>
                </div>
                <div class="bg-white rounded-lg p-3 text-center shadow-sm">
                    <div class="text-sm text-gray-600">Analysierte Spiele</div>
                    <div class="text-xl font-bold text-blue-600" id="total-games">--</div>
                </div>
                <div class="bg-white rounded-lg p-3 text-center shadow-sm">
                    <div class="text-sm text-gray-600">Aktive Ligen</div>
                    <div class="text-xl font-bold text-purple-600" id="active-leagues">--</div>
                </div>
            </div>
        </header>

        <!-- Enhanced Controls -->
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-8">
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 items-end">
                <!-- Date Selection -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <span class="flex items-center space-x-2">
                            <span>üìÖ</span>
                            <span>Spieltag</span>
                        </span>
                    </label>
                    <input type="date" id="match-date" 
                           class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200">
                </div>
                
                <!-- League Selection -->
                <div class="lg:col-span-2">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <span class="flex items-center space-x-2">
                            <span>üèÜ</span>
                            <span>Ligen (Mehrfachauswahl)</span>
                        </span>
                    </label>
                    <select id="league-select" multiple
                            class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent h-32 transition duration-200">
                        <!-- EUROP√ÑISCHE TOP-LIGEN -->
                        <optgroup label="England">
                            <option value="soccer_epl">Premier League</option>
                            <option value="soccer_efl_champ">Championship</option>
                            <option value="soccer_england_league1">League One</option>
                            <option value="soccer_england_league2">League Two</option>
                        </optgroup>
                        
                        <optgroup label="Deutschland">
                            <option value="soccer_germany_bundesliga">Bundesliga</option>
                            <option value="soccer_germany_2_bundesliga">2. Bundesliga</option>
                        </optgroup>
                        
                        <optgroup label="Spanien & Italien">
                            <option value="soccer_spain_la_liga">La Liga</option>
                            <option value="soccer_italy_serie_a">Serie A</option>
                        </optgroup>
                        
                        <optgroup label="Frankreich & Niederlande">
                            <option value="soccer_france_ligue_one">Ligue 1</option>
                            <option value="soccer_netherlands_eredivisie">Eredivisie</option>
                        </optgroup>
                        
                        <optgroup label="Weitere Europa">
                            <option value="soccer_portugal_primeira_liga">Primeira Liga</option>
                            <option value="soccer_belgium_first_div">Jupiler Pro League</option>
                            <option value="soccer_scotland_premier_league">Scottish Premiership</option>
                            <option value="soccer_turkey_super_league">Super Lig</option>
                            <option value="soccer_switzerland_superleague">Swiss Super League</option>
                            <option value="soccer_austria_bundesliga">Austrian Bundesliga</option>
                        </optgroup>
                        
                        <optgroup label="Europapokal">
                            <option value="soccer_uefa_champs_league">Champions League</option>
                            <option value="soccer_uefa_europa_league">Europa League</option>
                            <option value="soccer_uefa_europa_conference_league">Conference League</option>
                        </optgroup>
                    </select>
                    <p class="text-xs text-gray-500 mt-1">Halte Strg/Cmd f√ºr Mehrfachauswahl</p>
                </div>
                
                <!-- Action Button -->
                <div>
                    <button id="refresh" 
                            class="w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200 transform hover:scale-105 shadow-lg flex items-center justify-center space-x-2">
                        <span class="loading-pulse hidden" id="loading-spinner">‚è≥</span>
                        <span id="button-text">ü§ñ KI-Analyse starten</span>
                    </button>
                </div>
            </div>
            
            <!-- Quick Selection Buttons -->
            <div class="mt-4 flex flex-wrap gap-2">
                <button class="quick-select text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1 rounded-full transition duration-200" data-leagues="soccer_epl,soccer_germany_bundesliga,soccer_spain_la_liga">
                    Top 5 Ligen
                </button>
                <button class="quick-select text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1 rounded-full transition duration-200" data-leagues="soccer_epl">
                    Premier League
                </button>
                <button class="quick-select text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1 rounded-full transition duration-200" data-leagues="soccer_germany_bundesliga">
                    Bundesliga
                </button>
                <button class="quick-select text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1 rounded-full transition duration-200" data-leagues="soccer_uefa_champs_league">
                    Champions League
                </button>
                <button class="quick-select text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1 rounded-full transition duration-200" data-leagues="soccer_epl,soccer_efl_champ,soccer_england_league1,soccer_england_league2">
                    England Alle
                </button>
            </div>
        </div>

        <!-- Status with AI Indicator -->
        <div id="status" class="text-center text-lg font-medium text-gray-600 mb-6">
            <div class="flex items-center justify-center space-x-2">
                <span>ü§ñ</span>
                <span>Bereit f√ºr KI-Analyse</span>
            </div>
        </div>

        <!-- AI Insights Panel -->
        <div id="ai-insights" class="hidden mb-6">
            <div class="bg-gradient-to-r from-blue-50 to-indigo-100 border border-blue-200 rounded-xl p-4">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-bold">
                        AI
                    </div>
                    <div>
                        <div class="font-semibold text-blue-800">KI-Erkenntnisse</div>
                        <div class="text-sm text-blue-600" id="insights-text">Analysiere Muster und Trends...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Match List -->
        <div id="match-list" class="space-y-6">
            <!-- Content wird via JavaScript gef√ºllt -->
        </div>

        <!-- Footer with Stats -->
        <footer class="mt-12 text-center text-gray-500 text-sm">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                <div class="bg-white rounded-lg p-3 shadow-sm">
                    <div class="text-gray-600">System</div>
                    <div class="font-semibold">xG + KI-Analyse</div>
                </div>
                <div class="bg-white rounded-lg p-3 shadow-sm">
                    <div class="text-gray-600">Datenquellen</div>
                    <div class="font-semibold">Odds API + Team Form</div>
                </div>
                <div class="bg-white rounded-lg p-3 shadow-sm">
                    <div class="text-gray-600">Updates</div>
                    <div class="font-semibold">Echtzeit + Historisch</div>
                </div>
            </div>
            <p>Football xG Value Analyzer PRO ‚Ä¢ KI-gest√ºtzte Wettanalyse</p>
        </footer>
    </div>

    <script>
        // Quick Selection Funktion
        document.querySelectorAll('.quick-select').forEach(button => {
            button.addEventListener('click', function() {
                const leagues = this.getAttribute('data-leagues').split(',');
                const leagueSelect = document.getElementById('league-select');
                
                // Alle Optionen deselecten
                Array.from(leagueSelect.options).forEach(option => {
                    option.selected = false;
                });
                
                // Gew√ºnschte Ligen selecten
                leagues.forEach(leagueKey => {
                    const option = Array.from(leagueSelect.options).find(opt => opt.value === leagueKey);
                    if (option) option.selected = true;
                });
                
                // Update Active Leagues Anzeige
                updateActiveLeaguesCount();
            });
        });

        // Aktive Ligen Z√§hler
        function updateActiveLeaguesCount() {
            const selectedLeagues = Array.from(document.getElementById('league-select').selectedOptions);
            document.getElementById('active-leagues').textContent = selectedLeagues.length;
        }

        // Lade Performance-Daten f√ºr Header
        async function loadHeaderStats() {
            try {
                const response = await fetch('/api/performance');
                const data = await response.json();
                
                if (data && data.overall) {
                    const accuracy = data.overall.total > 0 
                        ? Math.round((data.overall.correct / data.overall.total) * 100)
                        : 0;
                    
                    document.getElementById('ai-accuracy').textContent = accuracy + '%';
                    document.getElementById('total-games').textContent = data.overall.total;
                    
                    // Entferne Loading Animation
                    document.getElementById('ai-accuracy').classList.remove('loading-pulse');
                }
            } catch (error) {
                console.log('Performance-Daten noch nicht verf√ºgbar');
            }
        }

        // Loading State f√ºr Button
        document.getElementById('refresh').addEventListener('click', function() {
            const button = this;
            const originalText = button.querySelector('#button-text').textContent;
            const spinner = button.querySelector('#loading-spinner');
            
            // Loading State
            spinner.classList.remove('hidden');
            button.querySelector('#button-text').textContent = 'Analysiere...';
            button.disabled = true;
            
            // Reset nach 30s falls etwas schief geht
            setTimeout(() => {
                spinner.classList.add('hidden');
                button.querySelector('#button-text').textContent = originalText;
                button.disabled = false;
            }, 30000);
        });

        // Initialisierung
        document.addEventListener('DOMContentLoaded', function() {
            updateActiveLeaguesCount();
            loadHeaderStats();
            
            // Update bei Liga-√Ñnderungen
            document.getElementById('league-select').addEventListener('change', updateActiveLeaguesCount);
        });
    </script>

    <script src="app.js"></script>
</body>
</html>
